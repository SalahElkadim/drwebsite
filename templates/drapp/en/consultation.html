{% extends "en/base_en.html" %}
{% load static %}
{% block title %}Request Consultation | Sabr Consult{% endblock %}
{% block meta_description %}
Request a specialized consultation from Sabr Linguistic & Forensic Consultancy. We provide forensic linguistic analysis, financial fraud detection, and cyber extortion or forgery case analysis with certified experts to support you legally.
{% endblock %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/about_en.css' %}">

<section class="consultation">
    <div class="consultation-form">
        <div class="form-header">
            <h2><i class="fas fa-comments"></i> <span>Request Consultation</span></h2>
            <p>Fill out the form and one of our experts will contact you within 24 hours.</p>
        </div>

        <form id="consultationForm">
            {% csrf_token %}

            <div class="form-group">
                <label for="name">Full Name</label>
                <input type="text" id="name" class="form-control" required placeholder="Enter your name here">
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" class="form-control" required placeholder="example@domain.com">
            </div>

            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" class="form-control" required placeholder="+966XXXXXXXXX">
            </div>

            <div class="form-group">
                <label for="service">Type of Service Required</label>
                <select id="service" class="form-control" required>
                    <option value="" disabled selected>Select a Service</option>
                    <option value="Forensic Linguistic Analysis">Forensic Linguistic Analysis</option>
                    <option value="Financial Fraud Detection">Financial Fraud Detection</option>
                    <option value="Cyber Extortion Cases">Cyber Extortion Cases</option>
                    <option value="Cyber Forgery Cases">Cyber Forgery Cases</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <div class="form-group">
                <label for="message">Consultation Details</label>
                <textarea id="message" class="form-control" required placeholder="Tell us more about your needs..." rows="5"></textarea>
            </div>

            <button type="submit" class="submit-btn">
                <i class="fas fa-paper-plane"></i> <span>Submit Request</span>
            </button>

            <div class="success-message" id="successMessage" style="display: none;">
                <i class="fas fa-check-circle" style="font-size: 40px; margin-bottom: 10px;"></i>
                <h3>Your request has been sent successfully!</h3>
                <p>We will contact you within 24 business hours.</p>
            </div>
        </form>
    </div>
</section>

<script>
    document.getElementById('consultationForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const data = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            service: document.getElementById('service').value,
            message: document.getElementById('message').value,
        };

        fetch('https://sabrconsult.com/submit-consultation/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify(data)
        })
        .then(res => res.json())
        .then(res => {
            if (res.status === 'success') {
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('consultationForm').reset();
            } else {
                alert('An error occurred while sending the form.');
            }
        });

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    });
</script>
{% endblock %}
